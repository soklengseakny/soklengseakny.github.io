<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Current Info</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"
        integrity="sha512-i8+QythOYyQke6XbStjt9T4yQHhhM+9Y9yTY1fOxoDQwsQpKMEpIoSQZ8mVomtnVCf9PBvoQDnKl06gGOOD19Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        #top-title {
            text-align: center;
        }

        table {
            border-top: 2px solid rgba(0, 0, 0, 0.363) !important;
        }

        #container-div {
            padding-left: 1em;
            padding-right: 1em;
        }

        .fa-arrow-up {
            color: darkgreen;
        }

        .fa-arrow-down {
            color: red;
        }
    </style>
</head>

<body>
    <h1><i class="fab fa-500px"></i></h1>
    <div class="col-lg-6 col-sm-12 offset-lg-3 pt-3" id="container-div">
        <h1 id="top-title">Crypto Realtime Info</h1>
        <table class="table mt-4">
            <thead>
                <tr>
                    <th width="20%">Crypto</th>
                    <th width="45%">Price</th>
                    <th width="35%">Balance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Shiba</td>
                    <td id="shiba-price"><span>$0</span><span></span></td>
                    <td id="shiba-balance"><span>$0</span><span></span></td>
                </tr>
                <tr>
                    <td>Doge</td>
                    <td id="doge-price"><span>$0</span><span></span></td>
                    <td id="doge-balance"><span>$0</span><span></span></td>
                </tr>
                <tr>
                    <td colspan="2"><b>TOTAL</b></td>
                    <td id="total-balance"><span>$0</span><span></span></td>
                </tr>
                <tr>
                    <td colspan="2"><b>Invest</b></td>
                    <td id="invest-amount"><span>$0</span></td>
                </tr>
                <tr>
                    <td colspan="2"><b>Profit</b></td>
                    <td id="total-profit"><span>$0</span><span></span></td>
                </tr>
                <tr>
                    <td colspan="2"><b>Profit Per Day</b></td>
                    <td id="profit-per-day">$0</td>
                </tr>
            </tbody>
        </table>
        <table class="table mt-4">
            <thead>
                <tr>
                    <th width="40%">Info Name</th>
                    <th width="25%"></th>
                    <th width="35%">Info Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="2">Invest Date</td>
                    <td><span>15-11-2021</span></td>
                </tr>
                <tr>
                    <td colspan="2">Today Date</td>
                    <td id="today-date"></td>
                </tr>
                <tr>
                    <td colspan="2">Total Invest Days</td>
                    <td id="total-invest-day"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        var previousShiba = 0;
        var previousDoge = 0;
        var previousProfit = 0;
        async function getCryptoPrice(id) {
            return new Promise((resolve, reject) => {
                $.ajax({
                    url: `https://api.binance.com/api/v3/ticker/price?symbol=${id}`,
                    type: 'GET',
                    success: (response) => {
                        resolve(response)
                    },
                    error: (error) => {
                        reject(error)
                    }
                })
            })
        }

        async function updateUI() {
            const shibaCoinBalance = 116406074.53;
            const dogeCoinBalance = 6356.18191579;
            var totalBalance = 0;
            await getCryptoPrice('SHIBUSDT').then(response => {
                const shibaBalanceUSD = parseFloat(response.price) * shibaCoinBalance;
                totalBalance += shibaBalanceUSD;
                $('#shiba-price span:first-child').text('$' + response.price);
                $('#shiba-balance span:first-child').text('$' + numberWithCommas((shibaBalanceUSD).toFixed(
                    2)));
                $('#shiba-balance span:nth-child(2)').html(
                    ` <i class="fa fa-arrow-${(response.price > previousShiba) ? 'up' : 'down'}"></i>`);
                previousShiba = response.price;
            }).catch(error => {
                console.log(error)
            });
            await getCryptoPrice('DOGEUSDT').then(response => {
                const dogeBalanceUSD = parseFloat(response.price) * dogeCoinBalance;
                totalBalance += dogeBalanceUSD;
                $('#doge-price span:first-child').text('$' + response.price);
                $('#doge-balance span:first-child').text('$' + numberWithCommas((dogeBalanceUSD).toFixed(
                    2)));
                $('#doge-balance span:nth-child(2)').html(
                    ` <i class="fa fa-arrow-${(response.price > previousDoge) ? 'up' : 'down'}"></i>`);
                $('#total-balance span:first-child').html('<b>$' + numberWithCommas(totalBalance.toFixed(
                    2)) + '</b>');
                previousDoge = response.price;
            }).catch(error => {
                console.log(error)
            });;
            $('#invest-amount').text('$7,700');
            $('#total-profit span:first-child').text('$' + numberWithCommas((totalBalance - 7700).toFixed(2)));
            $('#total-profit span:nth-child(2)').html(
                ` <i class="fa fa-arrow-${(totalBalance > previousProfit) ? 'up' : 'down'}"></i>`);
            previousProfit = totalBalance;
            $('#today-date').text(dateToDMY(new Date()));
            const dayCount = datediff(parseDate('11-15-2021'), parseDate(dateToMDY(new Date())));
            $('#total-invest-day').text(dayCount + ' Days');
            $('#profit-per-day').text('$' + ((totalBalance - 7700) / dayCount).toFixed(2));
        }

        function numberWithCommas(amount) {
            const preDecimal = amount.split('.')[0];
            const postDecimal = amount.split('.')[1];
            return preDecimal.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "." + postDecimal;
        }

        function dateToDMY(date) {
            var d = date.getDate();
            var m = date.getMonth() + 1; //Month from 0 to 11
            var y = date.getFullYear();
            return '' + (d <= 9 ? '0' + d : d) + '-' + (m <= 9 ? '0' + m : m) + '-' + y;
        }

        function dateToMDY(date) {
            var d = date.getDate();
            var m = date.getMonth() + 1; //Month from 0 to 11
            var y = date.getFullYear();
            return '' + (m <= 9 ? '0' + m : m) + '-' + (d <= 9 ? '0' + d : d) + '-' + y;
        }

        function parseDate(str) {
            var mdy = str.split('-');
            return new Date(mdy[2], mdy[0] - 1, mdy[1]);
        }

        function datediff(first, second) {
            return Math.round((second - first) / (1000 * 60 * 60 * 24));
        }

        $(document).ready(async () => {
            setInterval(() => {
                updateUI();
            }, 500);
        })
    </script>
</body>

</html>